let
    SplitAndRenameColumns = (input as text) as record =>
        let
            datePart = Text.Start(input, 10),
            isDate = try Date.From(DateTime.FromText(datePart)) otherwise null,
            splitPositions =
                if isDate <> null then {0, 1, 5, 6, 120}
                else {6, 120},
            splitResult = Text.SplitTextByPositions(input, splitPositions),
            columnNames =
                if isDate <> null then {"Date", "Field1", "Field2", "Field3", "Field4"}
                else {"Field1", "Field2"}
        in
            Record.FromList(splitResult, columnNames)
in
    SplitAndRenameColumns
